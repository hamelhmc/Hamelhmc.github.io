---
import type { Portafolio } from '@/data/model/manfred.interface';
import { Image } from 'astro:assets';
import Badge from '@/components/atoms/Badge.astro';
import Button from '@/components/atoms/Button.astro';
import SocialLinks from '@/components/molecules/SocialLinks.astro';

// Note: Ensure icons are available if needed separately, or if SocialLinks handles them.
// SocialLinks molecule handles the icons.

const { aboutMe, careerPreferences } = Astro.props as Portafolio;

// Extract contact data safely
const publicProfiles = careerPreferences?.contact?.publicProfiles || [];
const contactMails = careerPreferences?.contact?.contactMails || [];

const socialMediaLinks = {
  linkedin: publicProfiles.find((p) => p.type === 'linkedin')?.URL || '',
  github: publicProfiles.find((p) => p.type === 'github')?.URL || '',
  twitter: publicProfiles.find((p) => p.type === 'twitter')?.URL || '',
  email: contactMails[0] || '',
};

// Process description - first paragraph
const descriptionParagraphs = aboutMe.profile.description.split('\n\n').filter((p) => p.trim());
const aboutDescriptionParagraph = descriptionParagraphs[0] || aboutMe.profile.description;

// Professional title
const professionalTitle = aboutMe.profile.title.split('|')[0].trim();

// Location
const location = `${aboutMe.profile.location.municipality}, ${aboutMe.profile.location.country}`;
---

<!-- Hero Section - Liquid Glass Design -->
<div class="relative w-full min-h-[80vh] flex items-center justify-center overflow-hidden">
  <!-- Decorative glow orbs -->
  <div
    class="absolute top-1/4 left-1/2 -translate-x-1/2 w-[500px] h-[500px] bg-primary-500/10 rounded-full filter blur-[120px] animate-glow-pulse"
    aria-hidden="true">
  </div>
  <div
    class="absolute bottom-0 right-1/4 w-[300px] h-[300px] bg-accent-emerald-light/10 rounded-full filter blur-[80px]"
    aria-hidden="true">
  </div>

  <!-- Content -->
  <div class="relative z-10 w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-20">
    <div class="flex flex-col items-center text-center gap-8">
      <!-- Availability Badge -->
      <Badge variant="success" animate>Disponible para nuevos proyectos</Badge>

      <!-- Main Title -->
      <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold tracking-tight leading-[1.05] text-balance">
        <span class="text-gray-900 dark:text-txt-primary">{professionalTitle}</span>
        <br />
        <span class="text-gray-900 dark:text-txt-primary">con visi√≥n de</span>
        <br />
        <span
          class="bg-gradient-to-r from-primary-600 to-primary-700 dark:from-primary-400 dark:to-primary-500 bg-clip-text text-transparent">
          producto & calidad
        </span>
      </h1>

      <!-- Subtitle -->
      <p class="max-w-2xl text-base sm:text-lg md:text-xl text-gray-600 dark:text-txt-secondary leading-relaxed text-pretty">
        {aboutDescriptionParagraph}
      </p>

      <!-- CTA Buttons -->
      <div class="flex flex-col sm:flex-row items-center gap-4 mt-4">
        <!-- Primary CTA -->
        <Button
          href="./assets/HAMILTON_MERCADO_CUELLAR_CV.pdf"
          download
          target="_blank"
          rel="noopener noreferrer"
          variant="primary"
          size="lg"
        >
          <span>Ver CV</span>
          <svg class="w-5 h-5 transition-transform group-hover:translate-y-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10">
            </path>
          </svg>
        </Button>

        <!-- Secondary CTA -->
        <Button
          href={`mailto:${socialMediaLinks.email}`}
          variant="secondary"
          size="lg"
        >
          <span>Contactar</span>
          <svg class="w-5 h-5 transition-transform group-hover:translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </Button>
      </div>

      <!-- Social Links -->
      <SocialLinks links={socialMediaLinks} />

      <!-- Location -->
      <div class="flex items-center gap-2 text-gray-500 dark:text-txt-tertiary text-sm">
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path
            fill-rule="evenodd"
            d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
            clip-rule="evenodd">
          </path>
        </svg>
        <span>{location}</span>
      </div>
    </div>
  </div>

  <!-- Bottom gradient line -->
  <div class="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-primary/20 to-transparent" aria-hidden="true">
  </div>
</div>

<style>
  .animate-fade-in-up {
    animation: fadeInUp 0.8s ease-out forwards;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
