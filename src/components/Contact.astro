---
import LinkedInIcon from '@/components/icons/LinkedIn.astro';
import GitHubIcon from '@/components/icons/GitHub.astro';
import XIcon from '@/components/icons/X.astro';
import type { CareerPreferences } from '@/data/model/manfred.interface';

interface Props {
  careerPreferences: CareerPreferences;
}

const { careerPreferences } = Astro.props;

const publicProfiles = careerPreferences.contact.publicProfiles || [];
const contactMails = careerPreferences.contact.contactMails || [];

const email = contactMails[0] || '';

const socialLinks = {
  linkedin: publicProfiles.find((p) => p.type === 'linkedin')?.URL || '',
  github: publicProfiles.find((p) => p.type === 'github')?.URL || '',
  twitter: publicProfiles.find((p) => p.type === 'twitter')?.URL || '',
};

// Status text
const statusText =
  careerPreferences.status === 'searchingActively' ? 'Buscando activamente nuevas oportunidades' : 'Abierto a nuevas oportunidades';

const preferredRoles = careerPreferences.preferences?.preferredRoles || [];
---

<section id="contacto" class="py-24 scroll-mt-20" aria-labelledby="contact-heading">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-12 space-y-4">
      <span class="text-primary font-semibold text-sm tracking-[0.2em] uppercase">Contacto</span>
      <h2
        id="contact-heading"
        class="text-3xl sm:text-4xl md:text-5xl font-bold text-gray-900 dark:text-txt-primary tracking-tight leading-tight">
        Hablemos de tu<br />pr√≥ximo proyecto
      </h2>
      <p class="text-gray-600 dark:text-txt-secondary text-base md:text-lg max-w-xl mx-auto">
        {statusText} como {preferredRoles.slice(0, 2).join(' o ')}.
      </p>
    </div>

    <!-- Contact Buttons -->
    <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-12">
      <!-- Email Button - Primary -->
      {
        email && (
          <a
            href={`mailto:${email}`}
            class="w-full sm:w-auto inline-flex items-center justify-center gap-3 px-8 py-4 text-base font-semibold text-white bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 dark:from-primary-500 dark:to-primary-600 dark:hover:from-primary-400 dark:hover:to-primary-500 rounded-full shadow-glow-teal transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/50"
            aria-label={`Enviar email a ${email}`}>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" aria-hidden="true">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
              />
            </svg>
            <span class="truncate">{email}</span>
          </a>
        )
      }
    </div>

    <!-- Social Links Row -->
    <nav class="flex flex-wrap justify-center gap-4" aria-label="Redes sociales">
      {
        socialLinks.linkedin && (
          <a
            href={socialLinks.linkedin}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-5 py-3 text-sm font-medium text-gray-600 dark:text-txt-secondary bg-white/50 dark:bg-glass border border-gray-200/50 dark:border-glass-border hover:text-primary dark:hover:text-primary hover:border-primary/30 rounded-full backdrop-blur-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"
            aria-label="Perfil de LinkedIn">
            <LinkedInIcon class="w-5 h-5" />
            <span>LinkedIn</span>
          </a>
        )
      }
      {
        socialLinks.github && (
          <a
            href={socialLinks.github}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-5 py-3 text-sm font-medium text-gray-600 dark:text-txt-secondary bg-white/50 dark:bg-glass border border-gray-200/50 dark:border-glass-border hover:text-primary dark:hover:text-primary hover:border-primary/30 rounded-full backdrop-blur-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"
            aria-label="Perfil de GitHub">
            <GitHubIcon class="w-5 h-5" />
            <span>GitHub</span>
          </a>
        )
      }
      {
        socialLinks.twitter && (
          <a
            href={socialLinks.twitter}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-5 py-3 text-sm font-medium text-gray-600 dark:text-txt-secondary bg-white/50 dark:bg-glass border border-gray-200/50 dark:border-glass-border hover:text-primary dark:hover:text-primary hover:border-primary/30 rounded-full backdrop-blur-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"
            aria-label="Perfil de Twitter">
            <XIcon class="w-5 h-5" />
            <span>Twitter</span>
          </a>
        )
      }
      <a
        href="/"
        class="inline-flex items-center gap-2 px-5 py-3 text-sm font-medium text-gray-600 dark:text-txt-secondary bg-white/50 dark:bg-glass border border-gray-200/50 dark:border-glass-border hover:text-primary dark:hover:text-primary hover:border-primary/30 rounded-full backdrop-blur-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"
        aria-label="Portfolio">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" aria-hidden="true">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9">
          </path>
        </svg>
        <span>Portfolio</span>
      </a>
    </nav>
  </div>
</section>
